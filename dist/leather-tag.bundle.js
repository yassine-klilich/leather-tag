(()=>{"use strict";null==window.LeatherTag&&(window.LeatherTag=function(){const t=Object.freeze({el:null,initialTags:[],classList:[],disabled:!1,allowDuplicates:!0,placeholder:"",allowedTags:[],disallowedTags:[],autoComplete:[],regexPattern:null,maxTags:null,showAutoCompleteAfter:null,onClick:function(t){},onCreate:function(){},onBeforeTagAdd:function(){},onTagAdded:function(t){},onAllAdded:function(){},onBeforeTagRemove:function(){},onTagRemoved:function(t){},onAllRemoved:function(){},onInvalidTagValue:function(t){},onShowAutoComptele:function(){},onHideAutoComptele:function(){},onSelectAutoCompleteOption:function(t){},onFocus:function(t){},onBlur:function(t){},onInput:function(t){},onMaxTags:function(){},onEdit:function(t){}});function e(n=t){let o=t,s={tagsWrapper:null,inputElement:null,autoCompleteWrapper:null},l=[],a=!1,r=[],u=[],c=e.prototype.hideAutoComplete.bind(this),d=!1,m=null,p=!1;Object.defineProperty(this,"config",{get:()=>o,set:t=>{null!=t&&Object.keys(t).length>0&&(o=e._buildConfigObject(o,t),h.call(this),i.call(this),this.values=o.initialTags,this.disabled=o.disabled,this.autoComplete=o.autoComplete)}}),Object.defineProperty(this,"dom",{get:()=>s}),Object.defineProperty(this,"values",{get:()=>this.tagItems.map((t=>t.value)),set:t=>{if(t instanceof Array==0)throw new TypeError("ERROR[set.values] :: parameter is not instance of Array");this.tagItems=[],this.dom.tagsWrapper.innerHTML="",this.dom.tagsWrapper.appendChild(this.dom.inputElement),this.addAll(t)}}),Object.defineProperty(this,"tagItems",{get:()=>l,set:t=>l=t}),Object.defineProperty(this,"inputValue",{get:()=>this.dom.inputElement.value,set:t=>this.dom.inputElement.value=t}),Object.defineProperty(this,"disabled",{get:()=>a,set:t=>{switch(t){case!0:this.dom.tagsWrapper.classList.add(e.CLASS_NAMES.LEATHER_TAG_DISABLED);break;case!1:this.dom.tagsWrapper.classList.remove(e.CLASS_NAMES.LEATHER_TAG_DISABLED)}a=t}}),Object.defineProperty(this,"autoComplete",{get:()=>r,set:t=>{if(t instanceof Array==0)throw new TypeError("ERROR[set.autoComplete] :: parameter is not instance of Array");r=t,f.call(this,r)}}),Object.defineProperty(this,"shownAutoCompleteOptions",{get:()=>u,set:t=>u=t}),Object.defineProperty(this,"autoCompleteOpen",{get:()=>d,set:t=>{switch(t){case!0:d=!0,g.call(this);break;case!1:d=!1,E.call(this)}}}),Object.defineProperty(this,"_bindFuncHideAutoComplete",{get:()=>c,set:t=>c=t}),Object.defineProperty(this,"_currentFocusedAutoCompleteElement",{get:()=>m,set:t=>m=t}),Object.defineProperty(this,"_preventAddingTag",{get:()=>p,set:t=>p=t}),this.config=n,this.config.onCreate.call(this)}function i(){const t=document.getElementById(this.config.el);if(null==t)throw new Error("ERROR[_initGUI] :: target element not found");if(t instanceof HTMLDivElement){this.dom.tagsWrapper=t,this.dom.tagsWrapper.innerHTML="";for(let t=0;t<this.config.classList.length;t++){const e=this.config.classList[t];this.dom.tagsWrapper.classList.add(e)}this.dom.inputElement=document.createElement("input"),this.dom.tagsWrapper.classList.add(e.CLASS_NAMES.LEATHER_TAG),this.dom.inputElement.classList.add(e.CLASS_NAMES.LEATHER_TAG_INPUT),this.dom.tagsWrapper.appendChild(this.dom.inputElement),this.dom.inputElement.setAttribute("placeholder",this.config.placeholder||"Type and press Enter"),this.dom.autoCompleteWrapper=m.call(this),this.dom.tagsWrapper.addEventListener("click",r.bind(this)),this.dom.inputElement.addEventListener("focus",n.bind(this)),this.dom.inputElement.addEventListener("blur",o.bind(this)),this.dom.inputElement.addEventListener("input",s.bind(this)),this.dom.inputElement.addEventListener("keyup",l.bind(this)),this.dom.inputElement.addEventListener("keydown",a.bind(this))}}function n(t){if(this.inputValue.length>0){const t=this.getMatchedAutoCompleteValues(this.inputValue.toLowerCase());t.length>0&&L.call(this,t)}this.config.onFocus.call(this,t)}function o(t){this.config.onBlur.call(this,t)}function s(t){if(0==this.inputValue.length)f.call(this,this.autoComplete);else{const t=this.getMatchedAutoCompleteValues(this.inputValue.toLowerCase());t.length>0?L.call(this,t):this.hideAutoComplete()}this.config.onInput.call(this,t)}function l(t){"Escape"==t.key&&(this.dom.inputElement.blur(),this.hideAutoComplete())}function a(t){switch(t.key){case"Backspace":0==this.inputValue.length&&this.removeTag(this.tagItems.length-1);break;case"Enter":{const t=this.inputValue;t.trim().length>0&&null!=this.addTag(t)&&(this.inputValue="",this.hideAutoComplete())}}if(null!=this.autoComplete&&this.autoComplete.length>0)switch(t.key){case"ArrowUp":{let t=_.call(this,"previousElementSibling");this.inputValue=null==t?"":t}break;case"ArrowDown":{let t=_.call(this,"nextElementSibling");this.inputValue=null==t?"":t}}}function r(t){this.config.onClick.call(this,t),t.stopPropagation(),this.dom.inputElement.focus(),0==this.autoCompleteOpen&&L.call(this,this.autoComplete)}function h(){const t=this.config.allowedTags,e=this.config.disallowedTags;for(let i=0;i<t.length;i++){const n=t[i];for(let t=0;t<e.length;t++){if(n==e[t])throw new Error(`ERROR[_checkConfigValues] :: '${n}' can't be allowed and disallowed value`)}}}function u(t){const e=this.values.map((t=>t.toLowerCase())),i=t.toLowerCase();for(let t=0;t<e.length;t++){if(i==e[t])return c.call(this,t),!0}return!1}function c(t){null==this._setTimeoutAnimation&&(this._setTimeoutAnimation=setTimeout((()=>{d.call(this,t)}),1e3),this.tagItems[t].dom.tagItem.classList.add(e.CLASS_NAMES.LEATHER_TAG_ITEM_ANIMATION))}function d(t){null!=this._setTimeoutAnimation&&(this.tagItems[t].dom.tagItem.classList.remove(e.CLASS_NAMES.LEATHER_TAG_ITEM_ANIMATION),clearTimeout(this._setTimeoutAnimation),this._setTimeoutAnimation=null)}function m(){const t=document.createElement("div");return t.classList.add(e.CLASS_NAMES.LEATHER_TAG_AUTOCOMPLETE),t.addEventListener("click",(t=>t.stopPropagation())),t}function p(){if(this.autoCompleteOpen){const t=getComputedStyle(this.dom.tagsWrapper).display;if(null!=this.dom.tagsWrapper.parentElement&&"none"!=t){const t=this.dom.tagsWrapper.getBoundingClientRect();this.dom.autoCompleteWrapper.style.top=`${t.bottom}px`,this.dom.autoCompleteWrapper.style.left=`${t.left}px`,this.dom.autoCompleteWrapper.style.width=`${t.width}px`}}}function g(){const t=this.config.showAutoCompleteAfter;null!=this.dom.autoCompleteWrapper.parentElement||null!=t&&this.inputValue.length!=t||(document.body.appendChild(this.dom.autoCompleteWrapper),p.call(this),document.addEventListener("click",this._bindFuncHideAutoComplete),window.addEventListener("resize",this._bindFuncHideAutoComplete),this._scrollParent=A(this.dom.tagsWrapper),null!=this._scrollParent&&(this._scrollParent==document.documentElement&&(this._scrollParent=document),this._scrollParent.addEventListener("scroll",this._bindFuncHideAutoComplete)),this.config.onShowAutoComptele.call(this))}function E(){this.dom.autoCompleteWrapper.parentElement==document.body&&(document.body.removeChild(this.dom.autoCompleteWrapper),document.removeEventListener("click",this._bindFuncHideAutoComplete),window.removeEventListener("resize",this._bindFuncHideAutoComplete),null!=this._scrollParent&&(this._scrollParent.removeEventListener("scroll",this._bindFuncHideAutoComplete),this._scrollParent=null),null!=this._currentFocusedAutoCompleteElement&&(this._currentFocusedAutoCompleteElement.classList.remove(e.CLASS_NAMES.LEATHER_TAG_AUTOCOMPLETE_LI_FOCUSED),this._currentFocusedAutoCompleteElement=null),this.shownAutoCompleteOptions=[],this.config.onHideAutoComptele.call(this))}function f(t){this.dom.autoCompleteWrapper.innerHTML="",this.dom.autoCompleteList=null,this.shownAutoCompleteOptions=[],this._currentFocusedAutoCompleteElement=null;const e=document.createElement("ul");for(let i=0;i<t.length;i++){const n=t[i],o=document.createElement("li");this.shownAutoCompleteOptions.push(n),o.textContent=n,o.setAttribute("data-index",i),o.addEventListener("click",T.bind(this,n)),e.appendChild(o)}this.dom.autoCompleteWrapper.appendChild(e),this.dom.autoCompleteList=e}function T(t){this.config.onSelectAutoCompleteOption.call(this,t),null!=this.addTag(t)&&(this.inputValue="")}function A(t){return null==t?null:t.scrollHeight>t.clientHeight?t:A(t.parentNode)}function L(t){f.call(this,t),this.showAutoComplete()}function _(t){if(this.dom.autoCompleteList.childElementCount>0){if(null!=this._currentFocusedAutoCompleteElement&&(this._currentFocusedAutoCompleteElement.classList.remove(e.CLASS_NAMES.LEATHER_TAG_AUTOCOMPLETE_LI_FOCUSED),this._currentFocusedAutoCompleteElement=this._currentFocusedAutoCompleteElement[t]),null==this._currentFocusedAutoCompleteElement)switch(t){case"previousElementSibling":this._currentFocusedAutoCompleteElement=this.dom.autoCompleteList.children[this.dom.autoCompleteList.childElementCount-1];break;case"nextElementSibling":this._currentFocusedAutoCompleteElement=this.dom.autoCompleteList.children[0]}return this._currentFocusedAutoCompleteElement.classList.add(e.CLASS_NAMES.LEATHER_TAG_AUTOCOMPLETE_LI_FOCUSED),this.shownAutoCompleteOptions[parseInt(this._currentFocusedAutoCompleteElement.dataset.index)]}}return e.DefaultConfig=t,e._buildConfigObject=function(t,e){const i={},n=Object.keys(t);for(let o=0;o<n.length;o++){const s=n[o];1==e.hasOwnProperty(s)?i[s]=e[s]:i[s]=t[s]}return i},e.CLASS_NAMES=Object.freeze({LEATHER_TAG:"leather-tag",LEATHER_TAG_INPUT:"leather-tag__input",LEATHER_TAG_DISABLED:"leather-tag--disabled",LEATHER_TAG_AUTOCOMPLETE:"leather-tag__autocomplete",LEATHER_TAG_AUTOCOMPLETE_LI_FOCUSED:"leather-tag__autocomplete-li--focused",LEATHER_TAG_ITEM:"leather-tag__item",LEATHER_TAG_ITEM_ANIMATION:"leather-tag__item--animation",LEATHER_TAG_ITEM_DISABLED:"leather-tag__item--disabled",LEATHER_TAG_ITEM_EDIT:"leather-tag__item--edit",LEATHER_TAG_VALUE:"leather-tag__value",LEATHER_TAG_BTN_REMOVE:"leather-tag__btn-remove"}),e.prototype.addTag=function(t){if(null==t)throw new Error("ERROR[LeatherTag.addTag] :: parameter should not be null");if(this.config.onBeforeTagAdd.call(this),0==this._preventAddingTag){if(null!=this.config.maxTags&&this.tagItems.length==this.config.maxTags)return void this.config.onMaxTags.call(this);if(!("string"==typeof t||t instanceof String||t instanceof TagItem))throw new TypeError("ERROR[LeatherTag.addTag] :: param is not type of string or TagItem");let e={};if("string"==typeof t||t instanceof String?e.value=t.toString():e=t.config,0==this.isValueValid(e.value))return void this.config.onInvalidTagValue.call(this,e.value);let i=null;return t instanceof TagItem?(i=t,i.leatherTag=this):(e.leatherTag=this,i=new TagItem(e)),this.dom.tagsWrapper.insertBefore(i.dom.tagItem,this.dom.inputElement),this.tagItems.push(i),p.call(this),this.config.onTagAdded.call(this,i),i}this._preventAddingTag=!1},e.prototype.addAll=function(t){if(t instanceof Array==0)throw new TypeError("ERROR[LeatherTag.addAll] :: parameter is not instance of Array");t.forEach((t=>{this.addTag(t)})),this.config.onAllAdded.call(this)},e.prototype.removeTag=function(t){this.config.onBeforeTagRemove.call(this);let e=null;for(let i=0;i<this.tagItems.length;i++)if(i==t||this.tagItems[i]==t){this.dom.tagsWrapper.removeChild(this.tagItems[i].dom.tagItem),e=this.tagItems.splice(i,1)[0];break}return p.call(this),this.config.onTagRemoved.call(this,e),e},e.prototype.removeAll=function(){for(let t=0;t<this.tagItems.length;)this.removeTag(this.tagItems[t]);this.config.onAllRemoved.call(this)},e.prototype.getMatchedAutoCompleteValues=function(t){return this.autoComplete.filter((e=>e.toLowerCase().includes(t)))},e.prototype.showAutoComplete=function(){this.autoCompleteOpen=!0},e.prototype.hideAutoComplete=function(){this.autoCompleteOpen=!1},e.prototype.preventAddTag=function(){this._preventAddingTag=!0},e.prototype.isValueValid=function(t){return(null==this.config.regexPattern||0!=this.config.regexPattern.test(t))&&((0!=this.config.allowDuplicates||!u.call(this,t))&&(!(this.config.allowedTags.length>0&&0==this.config.allowedTags.map((t=>t.toLowerCase())).includes(t.toLowerCase()))&&!(this.config.disallowedTags.length>0&&this.config.disallowedTags.map((t=>t.toLowerCase())).includes(t.toLowerCase()))))},e}(),window.TagItem=function(){const t=Object.freeze({leatherTag:null,disabled:!1,readonly:!1,value:null,data:null,classList:[],template:{tagItem:()=>document.createElement("div"),tagValue:()=>document.createElement("span"),tagRemoveButton:()=>{const t=document.createElement("button");return t.innerHTML='<svg width="14" height="14" viewBox="0 0 48 48"><path d="M38 12.83l-2.83-2.83-11.17 11.17-11.17-11.17-2.83 2.83 11.17 11.17-11.17 11.17 2.83 2.83 11.17-11.17 11.17 11.17 2.83-2.83-11.17-11.17z"/></svg>',t}},onClick:()=>{}});function e(e=t){let n=LeatherTag._buildConfigObject(t,e);if(null==n.value)throw new Error("ERROR[TagItem] :: Please provide a tag value");let o="",s=null,l=null,a=n.data,h=!1;Object.defineProperty(this,"leatherTag",{get:()=>s,set:t=>{if(null!=t&&!(t instanceof LeatherTag))throw new TypeError("ERROR[TagItem] :: value is not instance of LeatherTag");s=t}}),Object.defineProperty(this,"config",{get:()=>n}),Object.defineProperty(this,"dom",{get:()=>l}),Object.defineProperty(this,"value",{get:()=>o,set:t=>{o=t,this.dom.tagValue.textContent=t}}),Object.defineProperty(this,"data",{get:()=>a,set:t=>a=t}),Object.defineProperty(this,"disabled",{get:()=>h,set:t=>{switch(t){case!0:h=!0,this.dom.tagItem.classList.add(LeatherTag.CLASS_NAMES.LEATHER_TAG_ITEM_DISABLED),this.dom.tagItem.removeChild(this.dom.tagRemoveButton);break;case!1:h=!1,this.dom.tagItem.classList.remove(LeatherTag.CLASS_NAMES.LEATHER_TAG_ITEM_DISABLED),this.dom.tagItem.appendChild(this.dom.tagRemoveButton)}}}),r.call(this),l=i.call(this),this.disabled=n.disabled,this.leatherTag=n.leatherTag,this.value=n.value}function i(){let t=h.call(this,"tagItem");t.classList.add(LeatherTag.CLASS_NAMES.LEATHER_TAG_ITEM),t.addEventListener("click",(t=>t.stopPropagation())),t.addEventListener("dblclick",o.bind(this));for(let e=0;e<this.config.classList.length;e++)t.classList.add(this.config.classList[e]);let e=h.call(this,"tagValue");e.classList.add(LeatherTag.CLASS_NAMES.LEATHER_TAG_VALUE),e.addEventListener("keydown",s.bind(this)),e.addEventListener("blur",l.bind(this));let i=h.call(this,"tagRemoveButton");return i.classList.add(LeatherTag.CLASS_NAMES.LEATHER_TAG_BTN_REMOVE),i.addEventListener("click",n.bind(this)),t.appendChild(e),t.appendChild(i),{tagItem:t,tagValue:e,tagRemoveButton:i}}function n(t){t.stopPropagation(),this.remove(this)}function o(t){t.stopPropagation(),0==this.disabled&&(this.dom.tagItem.classList.add(LeatherTag.CLASS_NAMES.LEATHER_TAG_ITEM_EDIT),this.dom.tagValue.setAttribute("contenteditable",!0))}function s(t){"Enter"==t.key&&(t.preventDefault(),a.call(this,this.dom.tagValue.textContent)),"Escape"==t.key&&a.call(this,this.value)}function l(){a.call(this,this.dom.tagValue.textContent)}function a(t){this.dom.tagItem.classList.remove(LeatherTag.CLASS_NAMES.LEATHER_TAG_ITEM_EDIT),this.dom.tagValue.setAttribute("contenteditable",!1),this.value!=t&&this.updateValue(t)}function r(){this.config.template=LeatherTag._buildConfigObject(t.template,this.config.template);for(const t in this.config.template)if(Object.hasOwnProperty.call(this.config.template,t)&&"function"!=typeof this.config.template[t])throw new TypeError(`ERROR[TagItem] :: '${t}' must be a function returns a template.`)}function h(t){let e=this.config.template[t].call(this);if("string"!=typeof e&&!(e instanceof HTMLElement))throw new TypeError(`ERROR[TagItem] :: '${e}' template is not type of string or HTMLElement`);if("string"==typeof e){const t=document.createElement("div");if(t.innerHTML=e,e=t.firstElementChild,!(e instanceof HTMLElement))throw new TypeError(`ERROR[TagItem] :: '${e}' template is not type of HTMLElement`)}return e}return e.prototype.remove=function(){this.leatherTag instanceof LeatherTag&&(this.leatherTag.removeTag(this),this.leatherTag=null)},e.prototype.setLeatherTag=function(t){t!=this.leatherTag&&(this.remove(),t instanceof LeatherTag&&t.addTag(this))},e.prototype.updateValue=function(t){this.value=t,this.leatherTag instanceof LeatherTag&&this.leatherTag.config.onEdit.call(this.leatherTag,this)},e}())})();